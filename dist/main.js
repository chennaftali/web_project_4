(()=>{"use strict";const e=e=>{e.target.classList.contains("popup")&&(document.querySelector(".popup_open"),t(e.target))},t=t=>{t.classList.remove("popup_open"),document.removeEventListener("keydown",o),document.removeEventListener("mousedown",e)},o=e=>{if("Escape"===e.key){const e=document.querySelector(".popup_open");t(e)}},n=t=>{t.classList.add("popup_open"),document.addEventListener("keydown",o),document.addEventListener("mousedown",e)},r=document.querySelector(".popup__img-preview"),i=document.querySelector(".popup__header-img"),s=document.querySelector(".popup_type_image-preview");class a{constructor({name:e,link:t},o){this._name=e,this._link=t,this._templateCardSelector=o}_handleIamgeClick=()=>{r.src=this._link,r.alt=`photo of ${this._name}`,i.textContent=this._name,n(s)};_getElement=()=>document.querySelector(this._templateCardSelector).content.querySelector(".card__list-item").cloneNode(!0);_toggleLikeButton=e=>{e.target.classList.toggle("card__button_type_active")};_handleDelete=()=>{this._cardElement.remove()};createCard(){this._cardElement=this._getElement();const e=this._cardElement.querySelector(".card__img"),t=this._cardElement.querySelector(".card__title"),o=this._cardElement.querySelector(".card__button_type_delete"),n=this._cardElement.querySelector(".card__button_type-like");return e.src=this._link,e.alt=`photo of ${this._name}`,t.textContent=this._name,n.addEventListener("click",this._toggleLikeButton),o.addEventListener("click",this._handleDelete),e.addEventListener("click",this._handleIamgeClick),this._cardElement}}class l{constructor(e,t){this._setting=e,this._formElement=t,this._inputs=Array.from(this._formElement.querySelectorAll(e.inputSelector)),this._button=this._formElement.querySelector(e.submitButtonSelector)}resetValidation=()=>{this._inputs.forEach((e=>{this._hideError(e,this._setting)}))};_showError=e=>{const t=e.validationMessage,o=document.querySelector(`#${e.id}-error`);o.textContent=t,o.classList.add(this._setting.errorClass)};_hideError=e=>{const t=document.querySelector(`#${e.id}-error`);t.textContent="",t.classList.remove(this._setting.errorClass)};disableButton=()=>{this._button.disabled=!0,this._button.classList.add(this._setting.inactiveButtonClass)};_enableButton=()=>{this._button.disabled=!1,this._button.classList.remove(this._setting.inactiveButtonClass)};_toggleInputError=e=>{e.validity.valid?this._hideError(e):this._showError(e)};_setEventListeners=()=>{this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this.toggleButtonState(this._inputs,this._button)}))}))};_isValid=()=>this._inputs.every((e=>e.validity.valid));toggleButtonState=()=>{this._isValid()?this._enableButton(this._button):this.disableButton(this._button)};enableValidation(){this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this.toggleButtonState()}))}))}}const c={inputSelector:".popup__content",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},u=document.querySelector(".popup__form_type-add"),_=document.querySelector(".popup__form_type-profile"),d=new l(c,u),p=new l(c,_);d.enableValidation(),p.enableValidation();const m=document.querySelector(".popup_type-edit"),h=document.querySelector(".popup_type_add-card"),y=document.querySelector(".popup_type_image-preview"),g=document.querySelector(".popup__form_type-profile"),v=document.querySelector(".popup__content_type_name"),E=document.querySelector(".popup__content_type_about-me"),S=document.querySelector(".popup__form_type-add"),b=document.querySelector(".popup__content_type_img-title"),q=document.querySelector(".popup__content_type_img-link"),L=document.querySelector(".profile__edit-button"),k=document.querySelector(".popup__close_type-proile"),f=document.querySelector(".popup__close_type_image-preview"),C=document.querySelector(".profile__add-button"),w=document.querySelector(".popup__close_type_add"),B=document.querySelector(".profile__name"),x=document.querySelector(".profile__explorer"),V=document.querySelector(".element__list"),j=e=>{const t=new a(e,"#card__template").createCard();V.prepend(t)};[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}].forEach(j),C.addEventListener("click",(function(){n(h),d.disableButton()})),L.addEventListener("click",(()=>{v.value=B.textContent,E.value=x.textContent,n(m),p.toggleButtonState(),p.resetValidation()})),k.addEventListener("click",(()=>{t(m)})),f.addEventListener("click",(()=>{t(y)})),g.addEventListener("submit",(function(e){e.preventDefault(),t(m),B.textContent=v.value,x.textContent=E.value,p.disableButton()})),w.addEventListener("click",(()=>{t(h)})),S.addEventListener("submit",(function(e){const o={name:b.value,link:q.value};j(o),t(h),S.reset()}))})();